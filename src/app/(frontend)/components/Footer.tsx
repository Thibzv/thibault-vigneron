import Link from 'next/link'
import React from 'react'
import { getPayload } from 'payload'
import config from '@/payload.config'
import Button from './Button'

export default async function Footer() {
  const payloadConfig = await config
  const payload = await getPayload({ config: payloadConfig })
  const footer = await payload.findGlobal({
    slug: 'footer',
    depth: 2,
  })

  if (!footer) {
    return null
  }

  return (
    <footer className="footer">
      <nav className="footer__nav">
        <div className="footer__item">
          <p className="footer__heading">Email</p>
          {footer.email && (
            <Link href={`mailto:${footer.email}`} title="Me contacter par email">
              {footer.email}
            </Link>
          )}
        </div>

        {footer.navLinks && footer.navLinks.length > 0 && (
          <div className="footer__item">
            <p className="footer__heading">Menu</p>
            <ul className="footer__menu">
              {footer.navLinks.map((link, key) => (
                <li key={key}>
                  <Link href={link.href || '#'} title={link.label || ''}>
                    {link.label}
                  </Link>
                </li>
              ))}
            </ul>
          </div>
        )}

        <div className="footer__item">
          <p className="footer__heading">Liens directs</p>
          <ul className="footer__ctas">
            {footer.ctaButtons &&
              footer.ctaButtons.map((button, key) => (
                <li key={key}>
                  <Button
                    variant={button.variant || 'secondary'}
                    href={button.href || '#'}
                    title={button.title || ''}
                    icon={button.icon || undefined}
                    border={Boolean(button.border)}
                  />
                </li>
              ))}
            {footer.linkedinUrl && (
              <li>
                <Link
                  className="footer__linkedin"
                  href={footer.linkedinUrl}
                  target="_blank"
                  rel="noopener noreferrer"
                  title="LinkedIn"
                >
                  <span className="icon-linkedin"></span>
                </Link>
              </li>
            )}
          </ul>
        </div>
      </nav>

      <nav className="footer__btm">
        <ul className="footer__legals">
          {footer.legalLinks &&
            footer.legalLinks.map((link, key) => {
              const linkWithPage = link as {
                page?: number | { id: number; title: string; slug?: string; pageType?: string }
              }
              const page =
                typeof linkWithPage.page === 'object' && linkWithPage.page !== null
                  ? linkWithPage.page
                  : null
              if (!page || typeof page === 'number') return null

              const href = page.pageType === 'home' ? '/' : `/${page.slug || ''}`
              const label = page.title || ''

              return (
                <li key={key}>
                  <Link href={href} title={label}>
                    {label}
                  </Link>
                </li>
              )
            })}
          {footer.copyright && <li>{footer.copyright}</li>}
        </ul>
      </nav>

      <svg
        xmlns="http://www.w3.org/2000/svg"
        fill="none"
        viewBox="0 0 1180 136"
        className="footer__name"
      >
        <path
          fill="#FEFEFE"
          d="M26.126 104.827v-84.47H0V1.661h73.265v18.694H47.553v84.471H26.126ZM82.355 104.827V0h20.735v44.174l-2.488-3.323c1.751-4.524 4.561-7.847 8.432-9.97 3.963-2.216 8.571-3.324 13.823-3.324 5.714 0 10.691 1.2 14.93 3.6 4.331 2.4 7.695 5.77 10.091 10.11 2.396 4.246 3.594 9.231 3.594 14.955v48.605h-20.735V60.653c0-2.954-.599-5.493-1.797-7.616-1.106-2.123-2.719-3.785-4.838-4.985-2.028-1.2-4.424-1.8-7.189-1.8-2.672 0-5.068.6-7.188 1.8a12.927 12.927 0 0 0-4.976 4.985c-1.106 2.123-1.659 4.662-1.659 7.616v44.174H82.355ZM165.107 104.827V29.219h20.735v75.608h-20.735Zm0-82.394V1.662h20.735v20.771h-20.735ZM243.315 106.489c-5.161 0-9.953-.923-14.376-2.77-4.332-1.938-7.834-4.754-10.506-8.447l1.935-4.292v13.847h-19.353V0h20.736v43.62l-3.18-4.154c2.488-3.785 5.852-6.693 10.091-8.724 4.332-2.123 9.262-3.185 14.791-3.185 7.189 0 13.686 1.754 19.492 5.262 5.805 3.508 10.413 8.263 13.823 14.263 3.41 5.909 5.115 12.556 5.115 19.941 0 7.293-1.705 13.94-5.115 19.94-3.318 6.001-7.879 10.756-13.685 14.264-5.806 3.508-12.395 5.262-19.768 5.262Zm-2.488-18.694c3.871 0 7.28-.877 10.229-2.632 2.949-1.754 5.253-4.2 6.912-7.339 1.659-3.139 2.488-6.739 2.488-10.801s-.829-7.616-2.488-10.663c-1.659-3.139-3.963-5.585-6.912-7.339-2.949-1.846-6.358-2.77-10.229-2.77-3.686 0-7.004.877-9.953 2.632-2.857 1.753-5.115 4.2-6.773 7.339-1.567 3.139-2.35 6.739-2.35 10.801s.783 7.662 2.35 10.801c1.658 3.14 3.916 5.585 6.773 7.34 2.949 1.754 6.267 2.63 9.953 2.63ZM317.389 106.489c-5.438 0-10.138-.877-14.1-2.631-3.963-1.754-7.004-4.247-9.124-7.478-2.119-3.323-3.179-7.247-3.179-11.77 0-4.247.967-7.986 2.903-11.217 1.935-3.323 4.884-6.093 8.847-8.309 4.055-2.215 9.077-3.785 15.067-4.708l23.086-3.739V71.87l-19.353 3.462c-2.949.554-5.207 1.523-6.774 2.908-1.566 1.292-2.35 3.185-2.35 5.677 0 2.308.876 4.108 2.627 5.4 1.751 1.293 3.916 1.94 6.497 1.94 3.41 0 6.405-.739 8.985-2.216 2.58-1.477 4.562-3.462 5.944-5.955 1.475-2.585 2.212-5.4 2.212-8.447V54.976c0-2.862-1.152-5.263-3.456-7.201-2.212-1.939-5.253-2.908-9.124-2.908-3.686 0-6.957 1.015-9.814 3.046-2.765 2.031-4.792 4.708-6.083 8.032l-16.588-7.893c1.475-4.247 3.825-7.894 7.05-10.94 3.226-3.047 7.096-5.4 11.612-7.062s9.446-2.493 14.791-2.493c6.359 0 11.981 1.154 16.865 3.462 4.884 2.308 8.663 5.539 11.335 9.693 2.765 4.062 4.147 8.817 4.147 14.263v49.852h-19.353V92.641l4.7-.83c-2.212 3.323-4.654 6.092-7.326 8.308a27.024 27.024 0 0 1-8.986 4.708c-3.317 1.108-7.003 1.662-11.058 1.662ZM401.713 106.489c-6.082 0-11.289-1.292-15.62-3.877-4.24-2.677-7.465-6.37-9.677-11.078-2.212-4.709-3.318-10.202-3.318-16.48V29.22h20.736v44.174c0 2.862.553 5.4 1.659 7.616a12.92 12.92 0 0 0 4.976 4.985c2.12 1.2 4.516 1.8 7.188 1.8 2.765 0 5.161-.6 7.188-1.8 2.12-1.2 3.733-2.862 4.839-4.985 1.198-2.215 1.797-4.754 1.797-7.616V29.219h20.735v75.608h-19.353V89.872l1.106 3.323c-1.751 4.524-4.608 7.893-8.571 10.109-3.87 2.123-8.432 3.185-13.685 3.185ZM457.371 104.827V0h20.735v104.827h-20.735ZM529.636 105.658c-9.124 0-16.22-2.446-21.289-7.34-4.976-4.984-7.464-11.908-7.464-20.77V47.22h-12.718V29.219h.691c3.871 0 6.82-.97 8.847-2.908 2.12-1.939 3.18-4.847 3.18-8.724v-5.54h20.735V29.22h17.694V47.22h-17.694v28.941c0 2.585.461 4.755 1.382 6.509.922 1.662 2.35 2.908 4.286 3.739 1.935.83 4.331 1.246 7.188 1.246.645 0 1.382-.046 2.212-.138a238.21 238.21 0 0 1 2.626-.277v17.586c-1.382.185-2.949.37-4.7.554-1.751.185-3.41.277-4.976.277ZM605.469 104.827 570.219 1.662h23.5l26.541 82.81h-4.699l26.541-82.81h23.5l-35.25 103.165h-24.883ZM674.713 104.827V29.219h20.736v75.608h-20.736Zm0-82.394V1.662h20.736v20.771h-20.736ZM747.669 135.292c-5.806 0-11.197-.969-16.174-2.908-4.976-1.938-9.261-4.662-12.855-8.17-3.502-3.416-6.037-7.478-7.603-12.186l19.214-6.785c1.014 3.508 3.088 6.277 6.221 8.308 3.133 2.031 6.866 3.047 11.197 3.047 3.41 0 6.359-.646 8.847-1.939 2.488-1.2 4.377-3 5.668-5.4 1.382-2.401 2.073-5.216 2.073-8.448v-17.31l4.009 4.986c-2.58 4.247-5.898 7.432-9.953 9.555-4.055 2.031-8.801 3.046-14.238 3.046-7.004 0-13.271-1.569-18.8-4.708-5.53-3.23-9.861-7.616-12.994-13.155-3.134-5.632-4.7-12.001-4.7-19.11 0-7.108 1.566-13.386 4.7-18.833 3.133-5.539 7.418-9.878 12.856-13.017 5.437-3.139 11.611-4.708 18.523-4.708 5.437 0 10.183 1.108 14.238 3.323 4.055 2.124 7.511 5.401 10.368 9.832l-2.627 4.985V29.22h19.353v71.592c0 6.647-1.612 12.556-4.838 17.726-3.225 5.262-7.649 9.37-13.27 12.324-5.53 2.954-11.935 4.431-19.215 4.431Zm-.691-53.037c3.502 0 6.543-.738 9.123-2.215 2.581-1.477 4.562-3.554 5.944-6.232 1.475-2.677 2.212-5.816 2.212-9.416 0-3.6-.737-6.74-2.212-9.416-1.474-2.77-3.502-4.893-6.082-6.37-2.58-1.57-5.575-2.355-8.985-2.355-3.502 0-6.636.785-9.4 2.355-2.673 1.477-4.792 3.6-6.359 6.37-1.475 2.677-2.212 5.816-2.212 9.416 0 3.508.737 6.6 2.212 9.278a17.544 17.544 0 0 0 6.359 6.37c2.764 1.477 5.898 2.215 9.4 2.215ZM800.259 104.827V29.219h19.353v14.955l-1.106-3.323c1.751-4.524 4.562-7.847 8.432-9.97 3.963-2.216 8.571-3.324 13.824-3.324 5.713 0 10.69 1.2 14.929 3.6 4.331 2.4 7.695 5.77 10.091 10.11 2.396 4.246 3.594 9.231 3.594 14.955v48.605h-20.735V60.653c0-2.954-.599-5.493-1.797-7.616-1.106-2.123-2.719-3.785-4.838-4.985-2.028-1.2-4.424-1.8-7.188-1.8-2.673 0-5.069.6-7.189 1.8a12.927 12.927 0 0 0-4.976 4.985c-1.106 2.123-1.659 4.662-1.659 7.616v44.174h-20.735ZM919.367 106.489c-8.018 0-14.976-1.754-20.874-5.262-5.898-3.6-10.46-8.401-13.685-14.402-3.226-6-4.838-12.647-4.838-19.94 0-7.57 1.658-14.31 4.976-20.218 3.41-5.909 7.972-10.57 13.685-13.986 5.714-3.416 12.165-5.124 19.353-5.124 5.99 0 11.289.97 15.897 2.908 4.608 1.846 8.479 4.477 11.612 7.893 3.225 3.416 5.668 7.386 7.326 11.91 1.659 4.43 2.489 9.277 2.489 14.54a35.62 35.62 0 0 1-.277 4.43c-.092 1.385-.322 2.586-.691 3.601h-56.538V57.607h44.788l-9.815 7.2c.922-3.97.876-7.477-.138-10.524-1.014-3.139-2.811-5.585-5.391-7.34-2.488-1.846-5.576-2.769-9.262-2.769-3.594 0-6.681.877-9.262 2.631-2.58 1.754-4.515 4.34-5.805 7.755-1.291 3.416-1.797 7.57-1.521 12.463-.369 4.247.138 7.986 1.521 11.217 1.382 3.23 3.502 5.77 6.358 7.616 2.857 1.754 6.313 2.631 10.368 2.631 3.686 0 6.82-.738 9.4-2.216 2.673-1.477 4.746-3.508 6.221-6.093l16.588 7.894c-1.475 3.692-3.825 6.923-7.05 9.693-3.134 2.77-6.866 4.939-11.197 6.508-4.332 1.477-9.078 2.216-14.238 2.216ZM967.518 104.827V29.219h19.353v18.14l-1.383-2.63c1.659-6.37 4.378-10.664 8.156-12.88 3.871-2.307 8.436-3.461 13.686-3.461h4.42V46.39h-6.49c-5.07 0-9.174 1.57-12.307 4.708-3.133 3.047-4.7 7.386-4.7 13.017v40.712h-20.735ZM1058.3 106.489c-7.46 0-14.28-1.708-20.46-5.124-6.08-3.415-10.96-8.078-14.65-13.986-3.59-6-5.39-12.786-5.39-20.356 0-7.662 1.8-14.448 5.39-20.356 3.69-5.909 8.57-10.57 14.65-13.986 6.18-3.416 13-5.124 20.46-5.124 7.47 0 14.24 1.708 20.32 5.124 6.09 3.415 10.92 8.078 14.52 13.986 3.68 5.908 5.53 12.694 5.53 20.356 0 7.57-1.85 14.356-5.53 20.356-3.6 5.908-8.43 10.57-14.52 13.986-6.08 3.416-12.85 5.124-20.32 5.124Zm0-18.694c3.78 0 7.05-.877 9.82-2.632 2.85-1.754 5.07-4.2 6.63-7.339 1.66-3.139 2.49-6.739 2.49-10.801s-.83-7.616-2.49-10.663c-1.56-3.139-3.78-5.585-6.63-7.339-2.77-1.846-6.04-2.77-9.82-2.77-3.78 0-7.09.924-9.95 2.77-2.86 1.754-5.12 4.2-6.77 7.34-1.57 3.046-2.35 6.6-2.35 10.662 0 4.062.78 7.662 2.35 10.801 1.65 3.14 3.91 5.585 6.77 7.34 2.86 1.754 6.17 2.63 9.95 2.63ZM1110.88 104.827V29.219h19.36v14.955l-1.11-3.323c1.75-4.524 4.56-7.847 8.43-9.97 3.96-2.216 8.57-3.324 13.83-3.324 5.71 0 10.69 1.2 14.92 3.6 4.34 2.4 7.7 5.77 10.1 10.11 2.39 4.246 3.59 9.231 3.59 14.955v48.605h-20.74V60.653c0-2.954-.59-5.493-1.79-7.616-1.11-2.123-2.72-3.785-4.84-4.985-2.03-1.2-4.42-1.8-7.19-1.8-2.67 0-5.07.6-7.19 1.8a12.851 12.851 0 0 0-4.97 4.985c-1.11 2.123-1.66 4.662-1.66 7.616v44.174h-20.74Z"
        />
      </svg>
    </footer>
  )
}
